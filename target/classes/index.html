<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Greeting App</title>
  <style>
    body { font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#f6f7fb; color:#111827; display:flex; align-items:center; justify-content:center; height:100vh; margin:0; }
    .card { width:clamp(320px,40vw,720px); background:white; box-shadow:0 6px 18px rgba(20,20,50,0.08); border-radius:12px; padding:24px; }
    h1 { margin:0 0 10px 0; font-size:20px; }
    .row { display:flex; gap:8px; margin-bottom:12px; }
    input[type="text"] { flex:1; padding:10px 12px; border:1px solid #e6e9ef; border-radius:8px; font-size:15px; }
    button { padding:10px 14px; border-radius:8px; border:0; background:#4f46e5; color:white; cursor:pointer; font-weight:600; }
    button:disabled { opacity:0.5; cursor:default; }
    .result { margin-top:10px; padding:12px; background:#f1f5ff; border-radius:8px; color:#1f2937; }
    .history { margin-top:16px; max-height:180px; overflow:auto; border-left:4px solid #eef2ff; padding-left:12px; }
    .history li { margin-bottom:8px; }
    .footer { font-size:12px; color:#6b7280; margin-top:12px; }
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Interactive Greeting</h1>
    <p>Type a name and press <strong>Greet</strong>.</p>

    <div class="row">
      <input id="nameInput" type="text" placeholder="Enter a name (or leave blank)" autocomplete="off" />
      <button id="greetBtn">Greet</button>
    </div>

    <div id="result" class="result" aria-live="polite" hidden></div>

    <h3 style="margin-top:16px; font-size:14px">Session history</h3>
    <ul id="history" class="history" aria-live="polite"></ul>

    <div class="footer">Powered by Spring Boot — endpoint: <code>/greet?name=...</code></div>
  </div>

  <script>
    (function(){
      const input = document.getElementById('nameInput');
      const btn = document.getElementById('greetBtn');
      const result = document.getElementById('result');
      const history = document.getElementById('history');

      async function greet(name){
        btn.disabled = true;
        result.hidden = false;
        result.textContent = 'Thinking...';

        try {
          // call the existing REST endpoint
          const url = new URL('/greet', window.location.origin);
          if (name) url.searchParams.set('name', name);

          const res = await fetch(url.toString(), { method: 'GET' });
          if (!res.ok) throw new Error('HTTP '+res.status);

          const text = await res.text();
          result.textContent = text;

          // append to session history
          const li = document.createElement('li');
          li.textContent = `${(new Date()).toLocaleTimeString()} — ${text}`;
          history.prepend(li);
        } catch (err) {
          console.error(err);
          result.textContent = 'Error: ' + err.message;
        } finally {
          btn.disabled = false;
          input.focus();
        }
      }

      btn.addEventListener('click', () => {
        greet(input.value.trim());
      });

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          greet(input.value.trim());
        }
      });

      // Nice-to-have: preload a greeting
      window.addEventListener('load', () => {
        // optional: show initial greeting
        // greet('');
      });
    })();
  </script>
</body>
</html>